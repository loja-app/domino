<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="theme-color" content="#263238">
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <link rel="manifest" href="/domino/manifest.json">
  <title>Placar Dominó</title>
  <style>
    /* Definindo variáveis de cores e estilos globais */
    :root {
      --cor-de-fundo-dupla1: #E53935;
      --cor-de-fundo-dupla2: #3867d6;
      --cor-de-fundo-gradiente-dupla1: #EF5350;
      --cor-de-fundo-gradiente-dupla2: #4b7bec;
      --cor-do-fundo-principal: #263238;
      --cor-placar: #FFFFFF;
      --raio-da-borda-botao: 0.625rem;
      --sombra-dos-elementos: 0 0.375rem 0.75rem rgba(0, 0, 0, 0.2);
      --cor-botao: #FFFFFF;
      --cor-botao-icone: #000000;
      --tamanho-botao: 4rem;
      --cor-botao-desfazer: rgba(255, 224, 130, 0.95);
      --cor-press: #D0D0D0;
      --transicao-duracao: 0.3s;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: var(--cor-do-fundo-principal);
      font-family: 'Roboto', sans-serif;
      user-select: none; /* Desativa a seleção de texto */
    }

    .container-principal {
      display: flex;
      flex-direction: column;
      height: 100%;
      padding: 0.525rem;
      gap: 0.525rem;
    }

    .cartao-dupla {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 1.25rem;
      border-radius: var(--raio-da-borda-botao);
      box-shadow: var(--sombra-dos-elementos);
      flex: 1;
      gap: 2rem;
    }

    .placar {
      font-size: 8rem;
      font-weight: 850;
      color: var(--cor-placar);
      text-align: center;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 3px 7px rgba(0, 0, 0, 0.15);
      width: 100%;
      flex-grow: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container-botoes {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      width: 100%;
    }

    .botao-pontos, .botao-desfazer {
      flex: 1;
      padding: 0.875rem;
      height: var(--tamanho-botao);
      border: none;
      border-radius: var(--raio-da-borda-botao);
      background-color: var(--cor-botao);
      color: var(--cor-botao-icone);
      box-shadow: var(--sombra-dos-elementos);
      font-size: 1.5rem;
      font-weight: 750;
      text-align: center;
      cursor: pointer;
      transition: background-color var(--transicao-duracao), transform var(--transicao-duracao);
      -webkit-tap-highlight-color: transparent; /* Remove destaque do toque */
    }

    .botao-desfazer {
      background-color: var(--cor-botao-desfazer);
      font-size: 1rem;
    }

    /* Efeito visual nos botões ao serem pressionados */
    .botao-pontos:active, .botao-desfazer:active {
      background-color: var(--cor-press);
      transform: scale(0.95);
    }

    .botao-desfazer svg {
      width: 2.0rem;
      height: 2.0rem;
      display: block;
      margin: 0 auto;
      pointer-events: none; /* Desativa interações no ícone */
    }

    button:focus {
      outline: none; /* Remove o contorno do botão ao clicar */
    }

    /* Layout em paisagem */
    @media (orientation: landscape) {
      .container-principal {
        flex-direction: row;
      }
    }

    /* Estilos de fundo das duplas */
    .dupla-1 {
      background: radial-gradient(circle, var(--cor-de-fundo-dupla1) 40%, var(--cor-de-fundo-gradiente-dupla1) 99%);
    }

    .dupla-2 {
      background: radial-gradient(circle, var(--cor-de-fundo-dupla2) 40%, var(--cor-de-fundo-gradiente-dupla2) 99%);
    }
  </style>
  <script>
    // Função para registrar o Service Worker de forma silenciosa, sem exibir erros
    const registrarServiceWorkerDeFormaSilenciosa = () => {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/domino/service-worker.js')
          .catch(() => {}); // Ignora qualquer erro durante o registro
      }
    };

    registrarServiceWorkerDeFormaSilenciosa();
  </script>
</head>
<body>
  <div class="container-principal"></div>

  <script>
    // Histórico de pontuação de cada dupla
    const historicoDePontuacao = [[], []];
    
    // Configurações das duplas, incluindo classes de estilo
    const duplasConfiguracoes = [
      { classe: 'dupla-1' },
      { classe: 'dupla-2' }
    ];

    // Seleciona o container principal onde as duplas serão inseridas
    const containerDeDuplas = document.querySelector('.container-principal');

    // Função para criar os botões de pontos para cada dupla
    const criarBotaoPontos = (pontos, placar, id) => {
      const botaoPontos = document.createElement('button');
      botaoPontos.classList.add('botao-pontos');
      botaoPontos.dataset.pontos = pontos;
      botaoPontos.textContent = pontos;

      // Adiciona evento de clique no botão de pontos
      botaoPontos.addEventListener('click', () => {
        placar.textContent = parseInt(placar.textContent) + pontos;
        historicoDePontuacao[id].push(pontos); // Adiciona os pontos ao histórico
      });

      return botaoPontos;
    };

    // Função para criar o botão de desfazer
    const criarBotaoDesfazer = (placar, id) => {
      const botaoDesfazer = document.createElement('button');
      botaoDesfazer.classList.add('botao-desfazer');
      botaoDesfazer.innerHTML = `
        <svg fill="#000000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M9,16 C9.85216986,16 10.2974338,15.0144864 9.78322518,14.3774732 L9.70710678,14.2928932 L7.41602684,12.0006549 C8.6852851,10.797551 10.6983085,10 13,10 C16.918278,10 20,12.3112915 20,15 C20,15.5522847 20.4477153,16 21,16 C21.5522847,16 22,15.5522847 22,15 C22,11.0612915 17.918278,8 13,8 C10.1933072,8 7.65904665,8.99693838 6.00030879,10.5849581 L3.70710678,8.29289322 C3.1045317,7.69031813 2.09281919,8.07233231 2.00598327,8.88636906 L2,9 L2,15 C2,15.5128358 2.38604019,15.9355072 2.88337887,15.9932723 L3,16 L9,16 Z"/>
        </svg>
      `;

      // Evento de clique para desfazer o último ponto adicionado
      botaoDesfazer.addEventListener('click', () => {
        if (historicoDePontuacao[id].length) {
          placar.textContent = parseInt(placar.textContent) - historicoDePontuacao[id].pop();
        }
      });

      return botaoDesfazer;
    };

    // Função para criar o cartão de cada dupla (com placar e botões)
    const criarCartaoParaCadaDupla = (duplaConfiguracao, id) => {
      const cartaoDupla = document.createElement('div');
      cartaoDupla.classList.add('cartao-dupla', duplaConfiguracao.classe);
      cartaoDupla.dataset.dupla = id;

      const placar = document.createElement('div');
      placar.classList.add('placar');
      placar.dataset.placar = id;
      placar.textContent = '0'; // Inicializa o placar com 0

      const containerBotoes = document.createElement('div');
      containerBotoes.classList.add('container-botoes');

      // Criação dos botões de pontos (5, 10, 20)
      [5, 10, 20].forEach(pontos => {
        const botaoPontos = criarBotaoPontos(pontos, placar, id);
        containerBotoes.appendChild(botaoPontos);
      });

      // Criação do botão de desfazer
      const botaoDesfazer = criarBotaoDesfazer(placar, id);
      containerBotoes.appendChild(botaoDesfazer);

      cartaoDupla.appendChild(placar);
      cartaoDupla.appendChild(containerBotoes);
      containerDeDuplas.appendChild(cartaoDupla);
    };

    // Criação dos cartões para cada dupla configurada
    duplasConfiguracoes.forEach((dupla, index) => criarCartaoParaCadaDupla(dupla, index));

    // Função para manter a tela ativa enquanto o jogo está sendo jogado
    const manterTelaSempreAtivaSemDesligar = async () => {
      let bloqueioDeTelaAtiva = null;

      const solicitarBloqueioDeTelaAtiva = async () => {
        try {
          if (!bloqueioDeTelaAtiva) {
            bloqueioDeTelaAtiva = await navigator.wakeLock.request('screen');
          }
        } catch (erro) {
          // Ignora qualquer erro se não conseguir bloquear a tela
        }
      };

      window.addEventListener('load', solicitarBloqueioDeTelaAtiva);
      document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
          solicitarBloqueioDeTelaAtiva(); // Solicita novamente o bloqueio quando a página fica visível
        }
      });
    };

    manterTelaSempreAtivaSemDesligar(); // Chama a função para manter a tela ativa
  </script>
</body>
</html>
